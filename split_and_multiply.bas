Function УмножитьЧисла(ячейка As Range) As Double  
    Dim текст As String  
    Dim части() As String  
    Dim результат As Double  
    Dim j As Integer  
    Dim текущаяЧасть As String  
    Dim число As Double  
    
    ' Читаем текст из ячейки  
    текст = ячейка.Value  
    
    ' Разделяем строку по "x"  
    части = Split(текст, "x")  
    
    ' Начинаем с 1, чтобы можно было умножать  
    результат = 1  
    Dim естьЧисло As Boolean  
    естьЧисло = False  
    
    ' Перебираем все части  
    For j = LBound(части) To UBound(части)  
        ' Обрезаем лишние пробелы  
        текущаяЧасть = Trim(части(j))  
        
        ' Проверяем, является ли часть числом  
        If IsNumeric(Replace(текущаяЧасть, ",", ".")) Then  
            ' Преобразуем в число и перемножаем  
            число = CDbl(Replace(текущаяЧасть, ",", "."))  
            результат = результат * число  
            естьЧисло = True  
        End If  
    Next j  
    
    ' Если найдены числа, возвращаем результат, иначе - 0  
    If естьЧисло Then  
        УмножитьЧисла = результат  
    Else  
        УмножитьЧисла = 0  
    End If  
End Function  
